# General Packer

# What is packer?

![image](https://static.packt-cdn.com/products/9781789610789/graphics/assets/9f14b8b8-352b-4de3-a8fa-ce3e7cb4dfda.png)[^1]

A packer is a tool that combines an executable file's code, data, and sometimes resources into a single package. It includes code to unpack the program dynamically and execute it, without altering the program's original purpose.

## What types of packers are there?

It is generally one or a combination of the following operations:[^2]

### Bundling

Makes a single executable with multiple files.

- [PyInstaller](https://pyinstaller.org/en/stable/)
- [cx_Freeze](https://cx-freeze.readthedocs.io/en/stable/)
- [py2exe](https://www.py2exe.org/)
- [PyOxidizer](https://github.com/indygreg/PyOxidizer)
- [Nuitka](https://nuitka.net/)
- [Briefcase](https://beeware.org/project/projects/tools/briefcase/)

### Compression

Compresses the executable to reduce its original size.

- [UPX](https://upx.github.io/)
- [PEtite](https://www.un4seen.com/petite/)
- [MPRESS](https://www.autohotkey.com/mpress/mpress_web.htm)
- [PECompact](https://bitsum.com/pecompact.htm)
- kkrunchy
- [ASPack](http://www.aspack.com/)

### Obfuscates

Obfuscates the executable by encodin/gencrypting it.

- ExeCryptor
- ELFCrypt
- [Code Virtualizer](https://www.oreans.com/CodeVirtualizer.php)
- Dotfuscator
- [ConfuserEx](https://mkaring.github.io/ConfuserEx/)
- [xorPacker](https://github.com/tmenochet/XorPacker)
- [Hyperion](https://www.kali.org/tools/hyperion/)

### Protection

Makes the reversing of the executable harder (i.e. using anti-debugging, anti-tampering or other tricks).

- ExeCryptor
- [Themida](https://github.com/redgate4/Themida)
- [ASProtect](http://www.aspack.com/asprotect64.html)
- [Enigma Protector](https://enigmaprotector.com/)
- [VMProtect](https://vmpsoft.com/)
- [ZProtect](http://www.jiami.net/)

### Virtualization

Embeds a virtual machine that virtualizes the instructions of executable files.
It uses a customized and different virtual instruction set every time to protect your application.
The virtual machine can be a simple interpreter or a complex virtualization engine, responsible for decrypting and executing the wrapped code at runtime.
Virtualization technology creates an abstraction layer, hiding the actual instructions and data of the malicious software within the virtual machine, making reverse engineering and detection more challenging.

- [Themida](https://github.com/redgate4/Themida)
- [ASProtect](http://www.aspack.com/asprotect64.html)
- [Enigma Protector](https://enigmaprotector.com/)
- [VMProtect](https://vmpsoft.com/)
- [Molebox](https://github.com/sudachen/Molebox)

## What it's used for?

Malware authors hide their malicious code behind this compression layer. This code is only decompressed and executed after the malware runs (in runtime mode), which helps malware authors bypass static signature-based detection.

1. Increased Difficulty for Static Analysis.
   - Obfuscation: Techniques used to obscure the code's logic and structure, making it harder for analysts to understand.
   - Multi-Layer Packing: Employing multiple layers of packing to further complicate analysis and increase resistance to detection.
2. Bypassing Signature Detection.
   - Changing File Signatures: Modifying the executable's file signature to evade detection by security software that relies on file signatures for identification.

By employing these tactics, malicious software authors aim to evade detection by security measures that rely on straightforward identification or behavioral analysis. This layered approach complicates the process for security analysts and software defenses, allowing the malware to operate undetected for longer periods and potentially causing harm to systems and data.

## Tools

- https://github.com/TheAenema/hm-pe-packer
- https://github.com/Nariod/RustPacker
- https://github.com/89luca89/pakkero

## Resource

- https://github.com/frank2/packer-tutorial
- https://www.codeproject.com/Articles/5317556/Creating-Your-Very-Own-x64-PE-Packer-Protector-fro

[^1]: [The process of unpacking a sample](https://subscription.packtpub.com/book/security/9781789610789/5/ch05lvl1sec01/exploring-packers)
[^2]: [awesome-executable-packing](https://github.com/packing-box/awesome-executable-packing)
